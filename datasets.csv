catalog,changed_on_utc,id,kind,schema,sql,table_name,database.database_name,database.id
mhe,2025-11-19T10:29:31.966942+0000,40,virtual,public,"select t.gestion
, t.mes
, t.mes_abrev
, case when t.mes < 10 then '0' || t.mes::varchar || '-' || t.mes_abrev else t.mes::varchar || '-' || t.mes_abrev end as mes_str
, t.fecha
, r.tipo_regalias_2
, r.tipo_regalia
, r.gobierno
, r.region
, sum(d.monto)/1000000 as monto
from dat_regalias_pagadas d
inner join dim_tiempo t on t.tiempo_dim_id = d.tiempo_dim_id
inner join dim_destino r on r.destino_dim_id = d.destino_dim_id
where d.fuente_dim_id = 2
and gestion >= 2006
and r.destino_dim_id <> 9
group by t.gestion
, t.mes
, t.mes_abrev
, t.fecha
, r.tipo_regalias_2
, r.tipo_regalia
, r.gobierno
, r.region
order by t.gestion
, t.mes
, t.mes_abrev
, t.fecha
, r.tipo_regalias_2
, r.tipo_regalia
, r.gobierno
, r.region",Regalias,mhe,6
carguios_anh,2025-08-11T18:26:53.500960+0000,8,virtual,public,"WITH fechas AS (
    SELECT generate_series(
        DATE '2025-06-01',  -- Cambiar por fecha_inicio
        DATE '2025-06-30',  -- Cambiar por fecha_fin
        INTERVAL '1 day'
    )::date AS fecha_actual
),
CombinedData AS (
    SELECT 
        rs.nombre_estacion, 
        rs.tipo_sucursal, 
        rs.propietario, 
        rs.representante_legal, 
        rs.nit, 
        rs.departamento, 
        rs.municipio, 
        rs.direccion, 
        rs.tipo_area, 
        rs.tipo_dependencia,
        f.fecha_actual AS fecha_combined,
        d.volumen AS volumen_diesel,
        ge.volumen AS volumen_gasolina_e,
        gep.volumen AS volumen_gasolina_e_plus,
        gpp.volumen AS volumen_gasolina_premiun_plus,
        gse.volumen AS volumen_gasolina_super_etanol,
        gup.volumen AS volumen_gasolina_ultra_premium,
        dp.volumen AS volumen_diesel_premium,
        db.volumen AS volumen_diesel_bio
    FROM 
        fechas f
    CROSS JOIN 
        registro_sucursales rs
    LEFT JOIN 
        ""Diesel"" d ON d.id_cod = rs.id_cod_unico AND d.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_especial ge ON ge.id_cod = rs.id_cod_unico AND ge.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_especial_plus gep ON gep.id_cod = rs.id_cod_unico AND gep.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_super_etanol gse ON gse.id_cod = rs.id_cod_unico AND gse.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_ultra_premium gup ON gup.id_cod = rs.id_cod_unico AND gup.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_premiun_plus gpp ON gpp.id_cod = rs.id_cod_unico AND gpp.fecha = f.fecha_actual
    LEFT JOIN 
        diesel_plus dp ON dp.id_cod = rs.id_cod_unico AND dp.fecha = f.fecha_actual
    LEFT JOIN 
        diesel_bio db ON db.id_cod = rs.id_cod_unico AND db.fecha = f.fecha_actual
)
SELECT DISTINCT * FROM CombinedData",consultas de ventas anh,ventas dia anh,3
mhe,2025-11-18T17:51:56.214504+0000,30,virtual,public,"select gestion::varchar, mes, mes_corto, case when mes < 10 then '0' || mes::varchar || '-' || mes_corto else mes::varchar || '-' || mes_corto end as mes_str,  fecha, gas_natural_mmmcd, gas_natural_variacion, petroleo_mbpd, petroleo_variacion, glp_tmd, glp_variacion from tmp_produccion_mensual",Producción Mensual,mhe,6
datos_anh_ypfb,2025-11-13T22:07:17.570595+0000,14,physical,public,,produccion_gnv,base de datos anh,1
LlamadasMhe,2025-11-25T19:30:48.345958+0000,49,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
GROUP by ui.funcionario,lf.llamadas_saliente 
ORDER BY minutos_finales DESC;
",llamadas_mhe_TOTAL 11/25/2025 12:21:24,llamadasMhe,7
LlamadasMhe,2025-11-25T15:45:38.113949+0000,48,virtual,public,"SELECT 
    lf.llamadas_saliente as Interno,
    COUNT(*) AS Total_Llamadas,
     (SUM(lf.duracion_min) + (SUM(lf.duracion_seg) / 60))::int AS Minutos_Totales
FROM llamadas_fin lf
GROUP BY lf.llamadas_saliente
HAVING (SUM(lf.duracion_min) * 60 + SUM(lf.duracion_seg)) > 900
ORDER BY Minutos_Totales DESC;",llamadas_mhe_TOTAL 11/25/2025 11:44:22,llamadasMhe,7
datos_anh_ypfb,2025-11-18T22:34:23.516374+0000,37,physical,public,,gasolina,base de datos anh,1
datos_anh_ypfb,2025-11-17T14:25:58.903813+0000,15,physical,public,,glpmi,base de datos anh,1
datos_anh_ypfb,2025-11-17T22:13:42.849367+0000,21,physical,public,,comercializacion_urea,base de datos anh,1
datos_anh_ypfb,2025-11-17T17:39:15.736846+0000,16,physical,public,,urea,base de datos anh,1
mhe,2025-11-18T14:42:11.025534+0000,27,virtual,public,"select gestion::varchar as gestion, fecha, gas_natural_mmmcd, gas_natural_variacion, liq_mbpd, liq_variacion, glp_tmd, glp_variacion from tmp_produccion_anual",Produccion Anual,mhe,6
datos_anh_ypfb,2025-11-18T13:30:44.515151+0000,26,physical,public,,prodcanerias,base de datos anh,1
datos_anh_ypfb,2025-11-17T20:36:00.844990+0000,17,physical,public,,glpme,base de datos anh,1
mhe,2025-11-18T02:23:30.044103+0000,22,virtual,public,"select gestion, beneficiario, renta_gestion, variacion from tmp_renta_petrolera
order by gestion",Renta Petrolera,mhe,6
datos_anh_ypfb,2025-11-17T21:07:06.709056+0000,18,physical,public,,conversiones_gnv,base de datos anh,1
mhe,2025-11-18T15:40:06.120248+0000,29,virtual,public,"select gestion::varchar as gestion, max as fecha, departamento, gas_natural_mmmcd, petroleo_mbpd, glp_tmd from tmp_produccion_anual_departamento ",Producción por Departamento,mhe,6
mhe,2025-11-18T20:46:19.542339+0000,34,virtual,public,"select gestion::varchar gestion, mes
, mes_corto
, case when mes < 10 then '0' || mes::varchar || '-' || mes_corto else mes::varchar || '-' || mes_corto end as mes_str
, departamento, sum(gas_natural_mmmcd) as gas_natural, sum(petroleo_mbpd) as petroleo, sum(glp_tmd) as glp_tmd from tmp_produccion_mensual_campo 
group by gestion, mes, mes_corto, departamento
order by gestion, mes, mes_corto, departamento",Producción Mensual por Departamento,mhe,6
mhe,2025-11-18T03:24:00.639225+0000,24,virtual,public,"select gestion, componente, renta_gestion, variacion * 100 as variacion from tmp_renta_petrolera_componente ",Renta Petrolera Componente,mhe,6
datos_anh_ypfb,2025-11-18T17:55:02.899618+0000,31,physical,public,,gasnaturalme,base de datos anh,1
datos_anh_ypfb,2025-11-18T15:33:51.631848+0000,28,physical,public,,refinacion,base de datos anh,1
