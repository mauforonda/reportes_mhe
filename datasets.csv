catalog,changed_on_utc,id,kind,schema,sql,table_name,database.database_name,database.id
mhe,2025-11-19T10:29:31.966942+0000,40,virtual,public,"select t.gestion
, t.mes
, t.mes_abrev
, case when t.mes < 10 then '0' || t.mes::varchar || '-' || t.mes_abrev else t.mes::varchar || '-' || t.mes_abrev end as mes_str
, t.fecha
, r.tipo_regalias_2
, r.tipo_regalia
, r.gobierno
, r.region
, sum(d.monto)/1000000 as monto
from dat_regalias_pagadas d
inner join dim_tiempo t on t.tiempo_dim_id = d.tiempo_dim_id
inner join dim_destino r on r.destino_dim_id = d.destino_dim_id
where d.fuente_dim_id = 2
and gestion >= 2006
and r.destino_dim_id <> 9
group by t.gestion
, t.mes
, t.mes_abrev
, t.fecha
, r.tipo_regalias_2
, r.tipo_regalia
, r.gobierno
, r.region
order by t.gestion
, t.mes
, t.mes_abrev
, t.fecha
, r.tipo_regalias_2
, r.tipo_regalia
, r.gobierno
, r.region",Regalias,mhe,6
LlamadasMhe,2025-12-03T15:24:16.850948+0000,53,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
lf.mes,
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
WHERE lf.mes = 'NOVIEMBRE'
GROUP by ui.funcionario,lf.llamadas_saliente , lf.mes 
ORDER BY llamadas_saliente DESC;",NOVIEMBRE_TABLA,llamadasMhe,7
LlamadasMhe,2025-12-03T15:05:07.573911+0000,51,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
lf.mes,
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
WHERE lf.mes = 'NOVIEMBRE'
GROUP by ui.funcionario,lf.llamadas_saliente , lf.mes 
ORDER BY llamadas_saliente DESC;",cargado de noviembre,llamadasMhe,7
LlamadasMhe,2026-01-19T21:33:24.554260+0000,60,virtual,public,"SELECT 
    ui.funcionario,
    lf.llamadas_saliente,
    COUNT(*) AS total_llamadas,
    ROUND(
        (SUM(lf.duracion_min) + SUM(lf.duracion_seg) / 60.0),
        2
    ) AS minutos_finales
FROM llamadas_fin lf
INNER JOIN usuario_interno ui 
    ON ui.interno = lf.llamadas_saliente
WHERE lf.mes = 'Diciembre3'
GROUP BY ui.funcionario, lf.llamadas_saliente
ORDER BY total_llamadas DESC;
",LLAMADAS DICIEMBRE DEL 8,llamadasMhe,7
carguios_anh,2025-08-11T18:26:53.500960+0000,8,virtual,public,"WITH fechas AS (
    SELECT generate_series(
        DATE '2025-06-01',  -- Cambiar por fecha_inicio
        DATE '2025-06-30',  -- Cambiar por fecha_fin
        INTERVAL '1 day'
    )::date AS fecha_actual
),
CombinedData AS (
    SELECT 
        rs.nombre_estacion, 
        rs.tipo_sucursal, 
        rs.propietario, 
        rs.representante_legal, 
        rs.nit, 
        rs.departamento, 
        rs.municipio, 
        rs.direccion, 
        rs.tipo_area, 
        rs.tipo_dependencia,
        f.fecha_actual AS fecha_combined,
        d.volumen AS volumen_diesel,
        ge.volumen AS volumen_gasolina_e,
        gep.volumen AS volumen_gasolina_e_plus,
        gpp.volumen AS volumen_gasolina_premiun_plus,
        gse.volumen AS volumen_gasolina_super_etanol,
        gup.volumen AS volumen_gasolina_ultra_premium,
        dp.volumen AS volumen_diesel_premium,
        db.volumen AS volumen_diesel_bio
    FROM 
        fechas f
    CROSS JOIN 
        registro_sucursales rs
    LEFT JOIN 
        ""Diesel"" d ON d.id_cod = rs.id_cod_unico AND d.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_especial ge ON ge.id_cod = rs.id_cod_unico AND ge.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_especial_plus gep ON gep.id_cod = rs.id_cod_unico AND gep.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_super_etanol gse ON gse.id_cod = rs.id_cod_unico AND gse.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_ultra_premium gup ON gup.id_cod = rs.id_cod_unico AND gup.fecha = f.fecha_actual
    LEFT JOIN 
        gasolina_premiun_plus gpp ON gpp.id_cod = rs.id_cod_unico AND gpp.fecha = f.fecha_actual
    LEFT JOIN 
        diesel_plus dp ON dp.id_cod = rs.id_cod_unico AND dp.fecha = f.fecha_actual
    LEFT JOIN 
        diesel_bio db ON db.id_cod = rs.id_cod_unico AND db.fecha = f.fecha_actual
)
SELECT DISTINCT * FROM CombinedData",consultas de ventas anh,ventas dia anh,3
LlamadasMhe,2026-01-14T23:01:41.417899+0000,57,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
WHERE lf.mes = 'DICIEMBRE2'
GROUP by ui.funcionario,lf.llamadas_saliente
ORDER BY total_llamadas desc;",LLAMADAS_CENTRAL2,llamadasMhe,7
mhe,2025-11-18T17:51:56.214504+0000,30,virtual,public,"select gestion::varchar, mes, mes_corto, case when mes < 10 then '0' || mes::varchar || '-' || mes_corto else mes::varchar || '-' || mes_corto end as mes_str,  fecha, gas_natural_mmmcd, gas_natural_variacion, petroleo_mbpd, petroleo_variacion, glp_tmd, glp_variacion from tmp_produccion_mensual",ProducciÃ³n Mensual,mhe,6
LlamadasMhe,2026-01-19T21:33:54.446135+0000,61,virtual,public,"SELECT 
    ui.funcionario,
    lf.llamadas_saliente,
    COUNT(*) AS total_llamadas,
    ROUND(
        (SUM(lf.duracion_min) + SUM(lf.duracion_seg) / 60.0),
        2
    ) AS minutos_finales
FROM llamadas_fin lf
INNER JOIN usuario_interno ui 
    ON ui.interno = lf.llamadas_saliente
WHERE lf.mes = 'Diciembre3'
GROUP BY ui.funcionario, lf.llamadas_saliente
ORDER BY total_llamadas DESC;
",LLAMADAS_8_TABLA,llamadasMhe,7
LlamadasMhe,2026-01-15T17:44:42.591385+0000,58,virtual,public,"SELECT 
    ui.funcionario,
    lf.llamadas_saliente,
    COUNT(*) AS total_llamadas,
    ROUND(
        (SUM(lf.duracion_min) + SUM(lf.duracion_seg) / 60.0),
        2
    ) AS minutos_finales
FROM llamadas_fin lf
INNER JOIN usuario_interno ui 
    ON ui.interno = lf.llamadas_saliente
WHERE lf.mes = 'DICIEMBRE2'
GROUP BY ui.funcionario, lf.llamadas_saliente
ORDER BY total_llamadas DESC;
",llamadas_diciembre,llamadasMhe,7
LlamadasMhe,2025-12-03T15:21:19.011032+0000,52,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
lf.mes,
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
WHERE lf.mes = 'NOVIEMBRE'
GROUP by ui.funcionario,lf.llamadas_saliente , lf.mes 
ORDER BY llamadas_saliente DESC;",Noviembre tabla,llamadasMhe,7
datos_anh_ypfb,2025-11-13T22:07:17.570595+0000,14,physical,public,,produccion_gnv,base de datos anh,1
LlamadasMhe,2025-11-25T19:30:48.345958+0000,49,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
GROUP by ui.funcionario,lf.llamadas_saliente 
ORDER BY minutos_finales DESC;
",llamadas_mhe_TOTAL 11/25/2025 12:21:24,llamadasMhe,7
LlamadasMhe,2026-01-12T16:34:40.378306+0000,56,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
WHERE lf.mes = 'DICIEMBRE'
GROUP by ui.funcionario,lf.llamadas_saliente
ORDER BY total_llamadas desc;",TABLA DICIEMBRE,llamadasMhe,7
LlamadasMhe,2025-12-03T14:39:19.830662+0000,50,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
lf.mes,
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
GROUP by ui.funcionario,lf.llamadas_saliente , lf.mes 
ORDER BY llamadas_saliente DESC;
",LLAMADAS OCTUBRE NOVIEMBRE,llamadasMhe,7
LlamadasMhe,2026-01-12T16:24:42.629323+0000,55,virtual,public,"
SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
lf.mes,
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
WHERE lf.mes = 'DICIEMBRE'
GROUP by ui.funcionario,lf.llamadas_saliente , lf.mes 
ORDER BY total_llamadas DESC;",LLAMADAS DE DICIEMBRE,llamadasMhe,7
LlamadasMhe,2025-12-03T15:27:07.558461+0000,54,virtual,public,"SELECT ui.funcionario,
lf.llamadas_saliente, 
COUNT(*) AS total_llamadas, 
CASE 
        WHEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))::int > 0 
            THEN (SUM(lf.duracion_min)+ (SUM(lf.duracion_seg)/60))
        ELSE 
            SUM(lf.duracion_seg)::numeric
    END AS minutos_finales
FROM llamadas_fin lf 
inner join usuario_interno ui on ui.interno = lf.llamadas_saliente 
WHERE lf.mes = 'NOVIEMBRE'
GROUP by ui.funcionario,lf.llamadas_saliente
ORDER BY total_llamadas desc;",NOVIEMBRE_TABLA_FIN,llamadasMhe,7
LlamadasMhe,2025-11-25T15:45:38.113949+0000,48,virtual,public,"SELECT 
    lf.llamadas_saliente as Interno,
    COUNT(*) AS Total_Llamadas,
     (SUM(lf.duracion_min) + (SUM(lf.duracion_seg) / 60))::int AS Minutos_Totales
FROM llamadas_fin lf
GROUP BY lf.llamadas_saliente
HAVING (SUM(lf.duracion_min) * 60 + SUM(lf.duracion_seg)) > 900
ORDER BY Minutos_Totales DESC;",llamadas_mhe_TOTAL 11/25/2025 11:44:22,llamadasMhe,7
LlamadasMhe,2026-01-19T21:25:36.673838+0000,59,virtual,public,"SELECT 
    ui.funcionario,
    lf.llamadas_saliente,
    COUNT(*) AS total_llamadas,
    ROUND(
        (SUM(lf.duracion_min) + SUM(lf.duracion_seg) / 60.0),
        2
    ) AS minutos_finales
FROM llamadas_fin lf
INNER JOIN usuario_interno ui 
    ON ui.interno = lf.llamadas_saliente
WHERE lf.mes = 'Diciembre3'
GROUP BY ui.funcionario, lf.llamadas_saliente
ORDER BY total_llamadas DESC;
",reportellamadas-desde-el-8,llamadasMhe,7
datos_anh_ypfb,2025-11-18T22:34:23.516374+0000,37,physical,public,,gasolina,base de datos anh,1
datos_anh_ypfb,2025-11-17T14:25:58.903813+0000,15,physical,public,,glpmi,base de datos anh,1
